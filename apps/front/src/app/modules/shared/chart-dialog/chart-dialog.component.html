<div class="flex flex-col w-[80vw] h-[80vh] p-10" [hidden]="isShow === false">
  <div class="flex flex-1 flex-row justify-center mb-5 text-xl min-h-9">
    <div class="flex-1 flex flex-row w-1/4 tems-center justify-start"> </div>

    <div
      class="flex flex-row max-w-prose flex-grow mx-5 text-gray1 line-clamp-2 text-center flex-wrap"
      >{{ mconfig?.chart?.title }}
    </div>

    <div class="flex-1 flex flex-row w-1/4 items-center justify-end"> </div>
  </div>

  <div class="flex flex-row mb-5 text-xl text-gray1 justify-start items-center">
    <div class="flex flex-1 flex-row" *ngIf="showNav === true">
      <div class="flex flex-row justify-start items-center">
        <ui-switch
          class="mb-1"
          [checked]="isData"
          (change)="toggleData()"
        ></ui-switch>

        <div class="flex h-9 ml-5 text-gray1 text-base items-center select-none"
          >Show Data</div
        >
      </div>

      <div class="flex-grow"></div>

      <div class="flex-1 flex flex-row items-center justify-end">
        <m-query-status [query]="query"></m-query-status>
      </div>

      <button
        data-cy="chartDialogRunButton"
        class="px-6 py-2 ml-5 text-white text-base rounded font-medium focus:outline-none bg-blue3 cursor-pointer"
        (click)="run()"
      >
        Run
      </button>

      <button
        data-cy="chartDialogExploreButton"
        class="px-6 py-2 ml-5 text-white text-base rounded font-medium focus:outline-none"
        [ngClass]="{
          'bg-blue3 cursor-pointer': canAccessModel === true,
          'bg-gray-400 cursor-default': canAccessModel !== true
        }"
        [disabled]="canAccessModel === false"
        (click)="explore($event)"
      >
        <div *ngIf="canAccessModel === true"> Explore </div>
        <div
          *ngIf="canAccessModel === false"
          nz-tooltip
          [nzTooltipTitle]="'No access to model'"
          nzTooltipPlacement="bottom"
        >
          Explore
        </div>
      </button>
    </div>
  </div>

  <m-bricks
    class="flex mb-10 max-h-[20%] max-w-max"
    *ngIf="isShow === true && mconfig?.filters.length > 0"
    [extendedFilters]="extendedFilters"
  ></m-bricks>

  <div
    *ngIf="isShow === true && sortedColumns?.length > 0"
    class="flex overflow-auto"
    [ngClass]="{
      'flex-grow': mconfig?.chart.type !== chartTypeEnumTable,
      'w-full max-w-max':
        mconfig?.chart.type === chartTypeEnumTable &&
        isSelectValid === true &&
        mconfig?.chart.isValid === true &&
        qData?.length > 0,
      'h-[400px]': isData === true,
      'h-full': isData === false
    }"
  >
    <m-chart-view
      class="w-full h-full overflow-auto"
      [sortedColumns]="sortedColumns"
      [qData]="qData"
      [chart]="mconfig?.chart"
      [queryStatus]="query?.status"
    ></m-chart-view>
  </div>

  <div
    *ngIf="isShow === true && isData === true && sortedColumns?.length > 0"
    class="flex flex-row mb-3 mt-10"
  >
    <ui-switch
      class="mb-1"
      [checked]="isFormat"
      (change)="toggleFormat()"
    ></ui-switch>

    <div class="flex h-9 ml-5 text-gray1 text-base items-center select-none"
      >Format Numbers</div
    >
  </div>

  <div
    *ngIf="isShow === true && isData === true && sortedColumns?.length > 0"
    class="flex h-1/3 overflow-auto max-w-max w-full"
  >
    <m-main-table
      [isEdit]="false"
      [isFormat]="isFormat"
      [mconfig]="mconfig"
      [qData]="qData"
      [sortedColumns]="sortedColumns"
    ></m-main-table>
  </div>

  <div
    class="flex flex-row mt-7 items-center justify-start"
    *ngIf="showNav === true"
  >
    <m-lock-closed-icon
      class="mb-1 mr-2 text-gray-400"
      *ngIf="canAccessModel === false"
      nz-tooltip
      [nzTooltipTitle]="'No access to model'"
      nzTooltipPlacement="bottom"
    ></m-lock-closed-icon>
    <div class="text-base font-semibold text-gray-400">Model:</div>
    <div
      (click)="goToModel(model.modelId)"
      class="ml-2 text-base font-semibold cursor-pointer hover:text-blue-500 focus:outline-none"
      >{{ model?.label | capitalize }}</div
    >
  </div>
</div>
