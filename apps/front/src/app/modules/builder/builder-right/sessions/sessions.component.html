<div class="bg-m0 relative flex h-full w-full flex-col rounded shadow">
  <div class="mb-6 mt-6 flex h-11 flex-shrink-0 flex-row items-center">
    <div class="ml-10 flex-shrink-0">
      <button
        type="button"
        class="border-s400 text-s500 hover:bg-s100 flex select-none flex-row items-center rounded border p-4 py-2 focus:outline-none"
        (click)="newSession()"
      >
        <div>New Session</div>
      </button>
    </div>

    <div class="flex flex-1"></div>

    <div *ngIf="isRefreshing" class="relative flex h-7 w-7 flex-shrink-0">
      <ngx-spinner
        [name]="spinnerName"
        color="#0084d1"
        bdColor="#00000000"
        size="default"
        type="ball-clip-rotate"
        [fullScreen]="false"
        [disableAnimation]="true"
        [zIndex]="99998"
      >
      </ngx-spinner>
    </div>

    <button
      tp="Refresh sessions"
      type="button"
      class="hover:bg-m200 ml-5 mr-12 flex h-9 w-9 flex-shrink-0 items-center justify-center rounded focus:outline-none"
      (click)="loadSessions()"
    >
      <m-refresh-icon></m-refresh-icon>
    </button>
  </div>

  <div class="divide-s300 ml-6 mr-6 flex flex-col divide-y">
    <div class="flex flex-row"></div>
    <div class="flex flex-row"></div>
  </div>

  <div
    *ngIf="sessions.length === 0"
    class="pointer-events-none absolute inset-0 flex select-none items-center justify-center text-xl"
  >
    Sessions are empty
  </div>

  <div
    *ngIf="sessions.length > 0"
    class="flex h-2 w-full flex-grow flex-col overflow-y-auto"
  >
    <ng-scrollbar
      [orientation]="'vertical'"
      [visibility]="'hover'"
      [appearance]="'compact'"
    >
      <div class="mt-2 h-full w-full pb-6">
        <div
          *ngFor="let session of sessions; trackBy: trackBySessionId"
          class="hover:bg-m50 group ml-6 mr-9 flex h-11 cursor-pointer select-none flex-row items-center rounded pl-6 pr-3"
          (click)="openSession(session)"
        >
          <span
            class="min-w-0 flex-1 truncate text-base"
            [ngClass]="{
              'text-m600 font-semibold': session.sessionId === sessionId,
              'text-s1': session.sessionId !== sessionId
            }"
            >{{ session.displayTitle }}</span
          >

          <span
            class="ml-5 flex-shrink-0 rounded-full px-2 py-0.5 text-sm"
            [ngClass]="{
              'bg-blue-100 text-blue-700': session.status === 'New',
              'bg-green-100 text-green-700': session.status === 'Active',
              'bg-yellow-100 text-yellow-700': session.status === 'Paused',
              'bg-red-100 text-red-700':
                session.status === 'Stopped' ||
                session.status === 'Error' ||
                session.status === 'Expired'
            }"
            >{{ session.status }}</span
          >

          <div
            class="ml-4 flex h-9 w-9 flex-shrink-0 items-center justify-center"
          >
            <button
              class="hover:bg-m200 invisible flex h-8 w-8 items-center justify-center rounded focus:outline-none group-hover:visible"
              [tp]="templateRenameSession"
              [tpHideOnEscape]="true"
              tpVariation="menu"
              className="my-menu"
              #tpRef="tippy"
              (click)="$event.stopPropagation()"
            >
              <m-dots-vertical-icon></m-dots-vertical-icon>
            </button>

            <ng-template #templateRenameSession>
              <div class="border-s4 bg-m0 w-48 rounded-md border-2 shadow-xl">
                <button
                  class="text-s1 hover:bg-m50 w-full px-4 py-2 text-left text-base focus:outline-none"
                  [ngClass]="{
                    'text-s400 cursor-default': session.status === 'New'
                  }"
                  [disabled]="session.status === 'New'"
                  (click)="tpRef.hide(); renameSession($event, session)"
                  >Rename Session</button
                >
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </ng-scrollbar>
  </div>
</div>
<div *ngIf="sessions$ | async"></div>
<div *ngIf="session$ | async"></div>
