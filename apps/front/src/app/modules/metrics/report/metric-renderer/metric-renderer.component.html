<div
  class="font-ms truncate"
  *ngIf="params.data.rowType !== rowTypeMetric"
  [ngClass]="{
    '': params.data.rowType === rowTypeHeader,
  }"
  >{{ params.value | capitalize }}</div
>

<div *ngIf="params.data.rowType === rowTypeMetric" class="font-ms">
  <div class="flex flex-col">
    <div class="flex flex-row">
      <div
        class="truncate"
        *ngIf="
          showMetricsModelName === false && showMetricsTimeFieldName === false
        "
      >
        <div class="select-none truncate">
          <span>{{ params.data.partNodeLabel | capitalize }}</span>

          <span class="ml-2 font-semibold">{{
            params.data.partFieldLabel | capitalize
          }}</span>
        </div>
      </div>

      <div
        class="truncate"
        *ngIf="
          showMetricsModelName === true && showMetricsTimeFieldName === true
        "
      >
        <div class="select-none truncate">
          <span>{{ params.data.partNodeLabel | capitalize }}</span>

          <span class="ml-2 font-semibold">{{
            params.data.partFieldLabel | capitalize
          }}</span>

          <span class="ml-2"
            >by {{ params.data.timeNodeLabel | capitalize }}</span
          >

          <span class="ml-2">{{
            params.data.timeFieldLabel | capitalize
          }}</span>

          <span class="ml-2">- {{ params.data.topLabel | capitalize }}</span>
        </div>
      </div>

      <div
        class="truncate"
        *ngIf="
          showMetricsModelName === true && showMetricsTimeFieldName === false
        "
      >
        <span>{{ params.data.partNodeLabel | capitalize }}</span>

        <span class="ml-2 font-semibold">{{
          params.data.partFieldLabel | capitalize
        }}</span>

        <span class="ml-2">- {{ params.data.topLabel | capitalize }}</span>
      </div>

      <div
        class="truncate"
        *ngIf="
          showMetricsModelName === false && showMetricsTimeFieldName === true
        "
      >
        <span>{{ params.data.partNodeLabel | capitalize }}</span>

        <span class="ml-2 font-semibold">{{
          params.data.partFieldLabel | capitalize
        }}</span>

        <span class="ml-2"
          >by {{ params.data.timeNodeLabel | capitalize }}</span
        >

        <span class="ml-2">{{ params.data.timeFieldLabel | capitalize }}</span>
      </div>
    </div>

    <div
      class="flex flex-row"
      *ngIf="
        params.data.rowType === rowTypeMetric &&
        metric.type === metricTypeModel &&
        (showParameters === true ||
          params.data.isParamsJsonValid === false ||
          params.data.isParamsSchemaValid === false)
      "
    >
      <div
        *ngIf="params.data.isRepParametersHaveError === true"
        class="text-red1 mr-5 mt-1 flex h-8 w-8 flex-shrink-0"
        tp="Parameters have an error"
        [tpIsEnabled]="
          params.data.isParamsJsonValid === false ||
          params.data.isParamsSchemaValid === false
        "
      >
        <m-exclamation-icon
          *ngIf="
            params.data.isParamsJsonValid === false ||
            params.data.isParamsSchemaValid === false
          "
        ></m-exclamation-icon>
      </div>

      <div class="truncate">
        <div class="flex flex-shrink-0">
          <m-bricks
            class="flex max-w-max flex-shrink-0 flex-row items-end justify-start overflow-auto"
            [extendedFilters]="parametersFilters"
            [isKeepBackgroundColor]="true"
            [listen]="listen"
            [parametersJson]="params.data.parametersJson"
            [showJson]="showJson"
            [onlyJson]="false"
            [jsonMaxHeight]="
              (params.data?.parametersJson || []).length > 0
                ? params.data?.finalRowHeight - 16
                : params.data?.finalRowHeight - 8
            "
          ></m-bricks>
        </div>
      </div>
    </div>

    <div
      class="flex flex-row truncate"
      *ngIf="
        params.data.rowType === rowTypeMetric && metric.type !== metricTypeModel
      "
    >
      {{ params.data.strParameters | capitalize }}
    </div>
  </div>
</div>

<div *ngIf="uiQuery$ | async"></div>
