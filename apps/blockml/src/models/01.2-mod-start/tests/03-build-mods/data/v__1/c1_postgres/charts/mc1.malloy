import '../ec1_order_items.malloy';

query: mc1 is ec1_order_items -> {
  where: 
    orders.created_at_day ~ f``,      -- { kind: 'timestamp', parsed: null }
    orders.created_at_day ~ f`null`,  -- { kind: 'timestamp', parsed: { operator: 'null' } }

    orders.created_at_day ~ f`now`,       -- operator: 'in', in: { moment: 'now' }
    orders.created_at_day ~ f`today`,     -- operator: 'in', in: { moment: 'today' }
    orders.created_at_day ~ f`yesterday`, -- operator: 'in', in: { moment: 'yesterday' }
    orders.created_at_day ~ f`tomorrow`,  -- operator: 'in', in: { moment: 'tomorrow' }

    orders.created_at_day ~ f`2025`,              -- operator: 'in', in: { moment: 'literal', literal: '2025', units: 'year' }
    orders.created_at_day ~ f`2025-Q1`,
    orders.created_at_day ~ f`2025-01`, 
    orders.created_at_day ~ f`2025-02-03-WK`, 
    orders.created_at_day ~ f`2025-02-03`, 
    orders.created_at_day ~ f`2025-02-03 04`, 
    orders.created_at_day ~ f`2025-02-03 04:05`, 
    orders.created_at_day ~ f`2025-02-03 04:05:06`,   -- operator: 'in', in: { moment: 'literal', literal: '2025-02-03 04:05:06' } -- no units
    orders.created_at_day ~ f`2025-02-03 04:05:06.7`, -- operator: 'in', in: { moment: 'literal', literal: '2025-02-03 04:05:06.7' } -- no units

    orders.created_at_day ~ f`this year`,         -- operator: 'in', in: { moment: 'this', units: 'year' }
    orders.created_at_day ~ f`this quarter`,
    orders.created_at_day ~ f`this month`,
    orders.created_at_day ~ f`this week`,
    orders.created_at_day ~ f`this day`,
    orders.created_at_day ~ f`this hour`,
    orders.created_at_day ~ f`this minute`,

    orders.created_at_day ~ f`last year`,         -- operator: 'in', in: { moment: 'last', units: 'year' }
    orders.created_at_day ~ f`last quarter`,
    orders.created_at_day ~ f`last month`,
    orders.created_at_day ~ f`last week`,
    orders.created_at_day ~ f`last day`,
    orders.created_at_day ~ f`last hour`,
    orders.created_at_day ~ f`last minute`,

    orders.created_at_day ~ f`next year`,         -- operator: 'in', in: { moment: 'next', units: 'year' }
    orders.created_at_day ~ f`next quarter`,
    orders.created_at_day ~ f`next month`,
    orders.created_at_day ~ f`next week`,
    orders.created_at_day ~ f`next day`,
    orders.created_at_day ~ f`next hour`,
    orders.created_at_day ~ f`next minute`,

    orders.created_at_day ~ f`monday`,            -- operator: 'in', in: { moment: 'monday', which: 'last' }
    orders.created_at_day ~ f`last monday`,       -- operator: 'in', in: { moment: 'monday', which: 'last' }
    orders.created_at_day ~ f`next monday`,       -- operator: 'in', in: { moment: 'monday', which: 'next' }

    orders.created_at_day ~ f`5 days ago`,        -- operator: 'in', in: { moment: 'ago',       units: 'day', n: '5' }
    orders.created_at_day ~ f`5 days from now`,   -- operator: 'in', in: { moment: 'from_now',  units: 'day', n: '5' }

    orders.created_at_day ~ f`5 days ago for 2 days`,         -- operator: 'for', units: 'day', n: '2', begin: { moment: 'ago',       units: 'day', n: '5' }
    orders.created_at_day ~ f`5 days from now for 2 days`,    -- operator: 'for', units: 'day', n: '2', begin: { moment: 'from_now',  units: 'day', n: '5' }

    orders.created_at_day ~ f`last 5 days`,       -- operator: 'last',    units: 'day', n: '5'
    orders.created_at_day ~ f`next 5 days`,       -- operator: 'next',    units: 'day', n: '5'
    orders.created_at_day ~ f`5 days`,            -- operator: 'in_last', units: 'day', n: '5'

    orders.created_at_day ~ f`before 2025-Q2`,                -- operator: 'before', before: { moment: 'literal', literal: '2025-Q2', units: 'quarter' }
    orders.created_at_day ~ f`before 2025-02-03-WK`,          -- operator: 'before', before: { moment: 'literal', literal: '2025-02-03-WK', units: 'week' }
    orders.created_at_day ~ f`before 2025-02-03 04:05:06.7`,  -- operator: 'before', before: { moment: 'literal', literal: '2025-02-03 04:05:06.7' }

    orders.created_at_day ~ f`after 2025-Q2`,                -- operator: 'after', after: { moment: 'literal', literal: '2025-Q2', units: 'quarter' }
    orders.created_at_day ~ f`after 2025-02-03-WK`,          -- operator: 'after', after: { moment: 'literal', literal: '2025-02-03-WK', units: 'week' }
    orders.created_at_day ~ f`after 2025-02-03 04:05:06.7`,  -- operator: 'after', after: { moment: 'literal', literal: '2025-02-03 04:05:06.7' }

    orders.created_at_day ~ f`before tuesday`,                -- operator: 'before', before: { moment: 'tuesday', which: 'last' }
    orders.created_at_day ~ f`starting tuesday`,              -- operator: 'before', before: { moment: 'tuesday', which: 'last' }, not: true
    orders.created_at_day ~ f`after tuesday`,                 -- operator: 'after',  after:  { moment: 'tuesday', which: 'last' }
    orders.created_at_day ~ f`through tuesday`,               -- operator: 'after',  after:  { moment: 'tuesday', which: 'last' }, not: true

    orders.created_at_day ~ f`last monday to next friday`,                  -- operator: 'to', fromMoment: { moment: 'monday', which: 'last' }, toMoment: { moment: 'friday', which: 'next' }
    orders.created_at_day ~ f`2025-01-02 03:04:05 to 2026-07-08 04:05:06`,  -- operator: 'to', fromMoment: { moment: 'literal', literal: '2025-01-02 03:04:05' }, toMoment: { moment: 'literal', literal: '2026-07-08 04:05:06' }
    
    orders.created_at_day ~ f`today or tomorrow`,  -- operator: 'or', members: [{ operator: 'in', in: { moment: 'today' } }, { operator: 'in', in: { moment: 'tomorrow' } }]

    -- orders.created_at_date ~ f``

    -- sale_price ~ f``,
    -- sale_price ~ f`1`,
    -- sale_price ~ f`<= 2`,
    -- sale_price ~ f`>= 3`,
    -- sale_price ~ f`< 4`,
    -- sale_price ~ f`> 5`,
    -- sale_price ~ f`null`,
    -- sale_price ~ f`(6 to 7)`,
    -- sale_price ~ f`(8 to 9]`,
    -- sale_price ~ f`[10 to 11)`,
    -- sale_price ~ f`[12 to 13]`,
    -- sale_price ~ f`14, 15`,
    -- sale_price ~ f`16 or 17, 18 or < 19`,
    -- sale_price ~ f`!= 20`,

    -- sale_price ~ f`not 1`,
    -- sale_price ~ f`not <= 2`,
    -- sale_price ~ f`not >= 3`,
    -- sale_price ~ f`not < 4`,
    -- sale_price ~ f`not > 5`,
    -- sale_price ~ f`not null`,
    -- sale_price ~ f`not (6 to 7)`,
    -- sale_price ~ f`not (8 to 9]`,
    -- sale_price ~ f`not [10 to 11)`,
    -- sale_price ~ f`not [12 to 13]`,
    -- sale_price ~ f`not 14, 15`,
    -- sale_price ~ f`not 16 and not 17, 18 and not < 19`,
    -- sale_price ~ f`not != 20`,

    -- sale_price ~ f`= 0`,
    -- sale_price ~ f`!= 0`,
    -- sale_price ~ f`= 14, 15`,
    -- sale_price ~ f`!= 14, 15`,
    -- sale_price ~ f`(21, 22)`,
    -- sale_price ~ f`not (21, 22)`,

    -- users.has_last_name ~ f``,
    -- 
    -- users.has_last_name ~ f`true`,
    -- users.has_last_name ~ f`false`,
    -- users.has_last_name ~ f`=false`,
    -- users.has_last_name ~ f`null`,
    -- 
    -- users.has_last_name ~ f`not true`,
    -- users.has_last_name ~ f`not false`,
    -- users.has_last_name ~ f`not =false`,
    -- users.has_last_name ~ f`not null`,
    -- 
    -- users.state ~ f``,
    -- 
    -- users.state ~ f`a%z`,
    -- users.state ~ f`b`,
    -- users.state ~ f`%c%`,
    -- users.state ~ f`s%`,
    -- users.state ~ f`%e`,
    -- users.state ~ f`null`,
    -- users.state ~ f`empty`,
    -- 
    -- users.state ~ f`-a%z`,
    -- users.state ~ f`-b`,
    -- users.state ~ f`-%c%`,
    -- users.state ~ f`-s%`,
    -- users.state ~ f`-%e`,
    -- users.state ~ f`-null`,
    -- users.state ~ f`-empty`,
    -- 
    -- users.state ~ f`OH, NY`,
    -- users.state ~ f`-NC, -ND`,
    -- users.state ~ f`UT, MT%`,
    -- users.state ~ f`\\%%`,
  group_by: users__state is users.state
  aggregate: orsers__orders_count is orders.orders_count
  limit: 10
}